import{g as x,c as P,r as _,u as y,j as D,k as w,h as C,a as h,d as p,b as S,m as k,n as b}from"./firebaseConfig-43041049.js";import{_ as V,o as r,c as u,a as t,f as g,F as f,d as I,h as a,i as n,v as N,t as v,e as L}from"./index-4db0a4da.js";const M={data(){return{productDetail:{title:"",category:"",originPrice:0,discountPercent:1,quantity:"",productImg:"",productImages:[],content:"",note_1:"",note_2:""},productsList:[],uploadedFile:""}},methods:{async getProducts(){(await x(P(p,"products"))).forEach(o=>{this.productsList.push(o.data()),console.log(this.productsList)})},newProduct(){this.productDetail={title:"",category:"",originPrice:0,discountPercent:1,quantity:"",productImg:"",productImages:[],content:"",note_1:"",note_2:""}},uploadMainImg(){let l=this.$refs.mainImgInput.files[0],o=l.name;console.log(l.name);let d=_(b,`product/${o}`);y(d,l).then(s=>{console.log("上傳成功"),D(s.ref).then(i=>{console.log("File available at",i),this.productDetail.productImg=i})})},uploadOtherImgs(){let l=this.$refs.fileInput.files[0],o=l.name;console.log(l.name);let d=_(b,`product/${o}`);y(d,l).then(s=>{console.log("上傳成功"),D(s.ref).then(i=>{console.log("File available at",i),this.productDetail.productImages.push({imgName:o,imgUrl:i}),console.log(this.productDetail.productImages)})})},deleteImg(l,o){console.log(l,o);const d=_(b,`product/${o}`);w(d).then(()=>{this.productDetail.productImages.splice(l,1),console.log(this.productDetail.productImages)}).catch(s=>{})},async uploadProduct(){const l=this.productDetail;await C(h(p,"products",this.productDetail.title),l),console.log("更新成功"),alert("更新商品成功！"),this.productsList=[],this.getProducts()},async editProduct(l){const o=h(p,"products",`${l}`),c=await S(o);c.exists()?(console.log("Document data:",c.data()),this.productDetail=c.data()):console.log("No such document!")},async deleteProduct(l){await k(h(p,"products",`${l}`)),this.productsList=[],this.getProducts()}},mounted(){this.getProducts()}},U={class:"row mb-2"},q=t("div",{class:"col-10"},[t("h4",{class:""},"商品列表")],-1),F={class:"col-2"},B=t("i",{class:"bi bi-plus-lg"},null,-1),O={class:"table table-hover text-center align-middle"},R=t("thead",null,[t("tr",null,[t("th",{style:{width:"10%"}},"分類"),t("th",{style:{width:"15%"}},"商品名稱"),t("th",{style:{width:"20%"}},"商品縮圖"),t("th",{style:{width:"15%"}},"售價"),t("th",{style:{width:"15%"}},"是否啟用"),t("th",{style:{width:"25%"}},"操作")])],-1),j=["src"],E=t("td",null,null,-1),Q=["onClick"],T=t("i",{class:"bi bi-pencil-square"},null,-1),z=["onClick"],A=t("i",{class:"bi bi-trash"},null,-1),G={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},H={class:"modal-dialog modal-lg"},J={class:"modal-content"},K=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},"編輯產品"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),W={class:"modal-body"},X={class:"row"},Y={class:"col-8"},Z={class:"mb-3"},$=t("label",{for:"productName",class:"form-label"},"產品名稱",-1),tt={class:"col-4"},ot=t("label",{for:"productCategory",class:"form-label"},"產品分類",-1),et=L('<option selected>請選擇產品分類</option><option value="手作皮件">手作皮件</option><option value="手工藝品">手工藝品</option><option value="農特產品">農特產品</option><option value="禮品禮盒">禮品禮盒</option><option value="其他類別">其他類別</option>',6),st=[et],lt=t("hr",null,null,-1),it={class:"row"},at={class:"col-6"},ct={class:"mb-5"},nt=t("label",{for:"originPrice",class:"form-label"},"產品售價",-1),dt={class:"mb-5"},rt=t("label",{for:"discountPercent",class:"form-label"},"產品折扣",-1),ut={class:"mb-5"},mt=t("label",{for:"productQuantity",class:"form-label"},"上架數量",-1),pt={class:"mb-5"},gt=t("label",{for:"productImg1"},"上傳產品主圖",-1),_t={class:"col-6"},ht=["src"],bt=t("hr",null,null,-1),ft={class:"d-flex mb-3"},vt=t("div",{class:"col-4 align-self-center"},[t("label",{for:"productImgs",class:"form-label mb-0"},"上傳其他產品圖（3張）：")],-1),yt={class:"col-8"},Dt={class:"row mb-8"},It=["src"],xt={class:"text-center mb-0"},Pt=["onClick"],wt=t("i",{class:"bi bi-x-lg"},null,-1),Ct=t("hr",null,null,-1),St={class:"my-2"},kt=t("label",{for:"activeIntro",class:"form-label"},"產品描述：",-1),Vt={class:"my-2"},Nt=t("label",{for:"activeIntro",class:"form-label"},"購物須知：",-1),Lt={class:"my-2"},Mt=t("label",{for:"activeIntro",class:"form-label"},"規格說明：",-1),Ut={class:"modal-footer"},qt=t("button",{type:"button",class:"btn btn-secondary text-white","data-bs-dismiss":"modal"},"關閉",-1);function Ft(l,o,c,d,s,i){return r(),u(f,null,[t("div",U,[q,t("div",F,[t("button",{type:"button",class:"btn btn-success text-white","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:o[0]||(o[0]=e=>i.newProduct())},[B,g(" 新增商品 ")])])]),t("table",O,[R,t("tbody",null,[(r(!0),u(f,null,I(s.productsList,e=>(r(),u("tr",{key:e.title},[t("td",null,v(e.category),1),t("td",null,v(e.title),1),t("td",null,[t("img",{class:"table-list-image",src:e.productImg,alt:""},null,8,j)]),t("td",null,v(e.originPrice),1),E,t("td",null,[t("button",{type:"button",class:"btn btn-primary text-white mb-2 mb-lg-0 me-lg-2","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:m=>i.editProduct(e.title)},[T,g(" 編輯 ")],8,Q),t("button",{type:"button",class:"btn btn-danger text-white",onClick:m=>i.deleteProduct(e.title)},[A,g(" 刪除 ")],8,z)])]))),128))])]),t("div",G,[t("div",H,[t("div",J,[K,t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[$,a(t("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>s.productDetail.title=e),type:"text",class:"form-control",id:"productName",placeholder:"請輸入產品名稱"},null,512),[[n,s.productDetail.title]])])]),t("div",tt,[ot,a(t("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>s.productDetail.category=e),class:"form-select",id:"productCategory","aria-label":"Default select example"},st,512),[[N,s.productDetail.category]])])]),lt,t("div",it,[t("div",at,[t("div",ct,[nt,a(t("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>s.productDetail.originPrice=e),type:"number",min:"0",class:"form-control",id:"originPrice"},null,512),[[n,s.productDetail.originPrice]])]),t("div",dt,[rt,a(t("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>s.productDetail.discountPercent=e),type:"number",min:"0",max:"1",class:"form-control",id:"discountPercent"},null,512),[[n,s.productDetail.discountPercent]])]),t("div",ut,[mt,a(t("input",{"onUpdate:modelValue":o[5]||(o[5]=e=>s.productDetail.quantity=e),type:"number",min:"0",class:"form-control",id:"productQuantity"},null,512),[[n,s.productDetail.quantity]])]),t("div",pt,[gt,t("input",{onChange:o[6]||(o[6]=e=>i.uploadMainImg()),ref:"mainImgInput",class:"form-control",type:"file",accept:"image/*",id:"productImg1"},null,544)])]),t("div",_t,[t("img",{class:"fluid-img-cover",src:s.productDetail.productImg,alt:""},null,8,ht)])]),bt,t("div",ft,[vt,t("div",yt,[t("input",{onChange:o[7]||(o[7]=e=>i.uploadOtherImgs()),ref:"fileInput",class:"form-control",type:"file",accept:"image/*",id:"activeImgs"},null,544)])]),t("div",Dt,[(r(!0),u(f,null,I(s.productDetail.productImages,(e,m)=>(r(),u("div",{key:m,class:"col-4"},[t("img",{class:"fluid-img-cover",id:"activityImg",src:e.imgUrl,alt:""},null,8,It),t("p",xt,[t("a",{href:"#",class:"text-decoration-none text-danger",onClick:Bt=>i.deleteImg(m,e.imgName)},[g(" 取消上傳"),wt],8,Pt)])]))),128))]),Ct,t("div",St,[kt,a(t("textarea",{"onUpdate:modelValue":o[8]||(o[8]=e=>s.productDetail.content=e),class:"form-control",name:"",id:"activeIntro",cols:"10",rows:"6"},null,512),[[n,s.productDetail.content]])]),t("div",Vt,[Nt,a(t("textarea",{"onUpdate:modelValue":o[9]||(o[9]=e=>s.productDetail.note_1=e),class:"form-control",name:"",id:"activeIntro",cols:"10",rows:"6"},null,512),[[n,s.productDetail.note_1]])]),t("div",Lt,[Mt,a(t("textarea",{"onUpdate:modelValue":o[10]||(o[10]=e=>s.productDetail.note_2=e),class:"form-control",name:"",id:"activeIntro",cols:"10",rows:"6"},null,512),[[n,s.productDetail.note_2]])])]),t("div",Ut,[qt,t("button",{onClick:o[11]||(o[11]=e=>i.uploadProduct()),type:"button",class:"btn btn-primary text-white","data-bs-dismiss":"modal"},"儲存商品")])])])])],64)}const jt=V(M,[["render",Ft]]);export{jt as default};
